<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=7,IE=8,IE=9,IE=10" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OneMap-OneMap Basic Search</title>
    
    <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="css/styles.css" />
    <link href='https://fonts.googleapis.com/css?family=Lato:400,300,700,900' rel='stylesheet' type='text/css'>
<script src="js/jquery.min.js"></script>	
<script src="scripts/jquery-2.1.3.min.js"></script>   
<script src="js/jquery.flip.min.js"></script>
  <script type='text/JavaScript' src='js/map-api.js'></script>
<script>
 var OneMap = new GetOneMap('mapDiv','SM');  
</script>
 
</head>
<body >
<div class="container hm">
<div class="flip-dv"><div id="flip">
	<img src="images/sg-logo.png"/>
<!--<i class="fa fa-bars"></i>--></div></div>
<div id="panel">
<ul>
<li>
<a href="home.html"><i class="fa fa-home"></i> Home</a>
</li>
<li>
<a href="search.html"><i class="fa fa-search"></i> Search</a>
</li>
<li>
<a href="javascript:void(0);" onclick="showhide()"><i class="fa fa-map-marker"></i> Lot View</a>
</li>
<li>
<a href="javascript:void(0);" onclick="logout()"><i class="fa fa-sign-out"></i> Log Out</a>
</li>
</ul>
</div>
<div id="content">
<div id="loader" style="background-image:url(images/loader.gif);position:absolute;"></div>
<div id="mapDiv"></div>
<div  id="cnti-box-tp" style="display:none;">
	<div class="inn-cnti">
    <p><i class="fa fa-cloud"></i><br />
	Map</p>
 	<input type="range" id="slider"  value="0.0" min="0.0" max="30.0" step="0.1" />
 	<p><i class="fa fa-map-marker"></i><br />
	Lot</p>
   </div>
   </div>

</div>
</div>
<script>
function logout()
{
window.localStorage.removeItem("loggedIn");
window.localStorage.removeItem("username");
window.location.href="index.html";
}
</script>
<script>
function showhide()
{
$('#cnti-box-tp').toggle();
$('.container').toggleClass('rwded');
//$("#panel").slideUp("slow");
} 
$(document).ready(function(){
    $("#flip").click(function(){
       // $("#panel").slideToggle("slow");
		$('.container').toggleClass('rwded');
    });
});
</script>
<script>


    console.log("Loading ArcGIS...");
    require(["esri/map","esri/symbols/PictureMarkerSymbol","esri/graphic",
            "esri/SpatialReference",
            "esri/geometry/Point",
            "dojo/on","dojo/domReady!"],
        function(Map,PictureMarkerSymbol,Graphic,SpatialReference,Point,on) {
            var helper = null;
$('#loader').show();
           
        


                navigator.geolocation.getCurrentPosition(locationSuccess,locationError,{setHighAccuracy:true});
				 function locationSuccess(position){
                if(position.coords.latitude != null || position.coords.longitude != null)
				{
				var xVal = position.coords.longitude;
				var yVal = position.coords.latitude;
				
				OneMap.showLocation(xVal,yVal);
                 $('#loader').hide();
                  
                }
            }
        function locationError(err){
                console.log("locationError: " + err.toString());
            }

            

        

         
          

        } 
    ); 
 </script>
<script src="scripts/jquery-2.1.3.min.js"></script>    

<script>
var count = 1;
var tiled;
$(document).on('input change', '#slider', function() {
var a = $(this).val();
if(a==0)
{
if(tiled!=""&&count!=1)
{
 
  
require(["esri/map", "esri/layers/ArcGISTiledMapServiceLayer", "dojo/domReady!"],
        function(Map, ArcGISTiledMapServiceLayer) {
var _baseMapHost = "http://www.onemap.sg/ArcGIS/rest/services/";
var tileHost1 = "http://t1.onemap.sg/ArcGIS/rest/services/"
var tileHost2 = "http://t2.onemap.sg/ArcGIS/rest/services/";
var _baseMapURL;
var _baseMapURL1;
var _baseMapURL2;
        _baseMapURL = _baseMapHost + "basemap" + "/MapServer";
        _baseMapURL1 = tileHost1 + "basemap" + "/MapServer";
        _baseMapURL2 = tileHost2 + "basemap" + "/MapServer";
   var request = new XMLHttpRequest();
   
          OneMap.map.addLayer(new OM.CustomTileServiceLayer());
          
		  
		  
        }
      );
  
}
}

if(a==30)
{
 require(["esri/map", "esri/layers/ArcGISTiledMapServiceLayer", "dojo/domReady!"],
        function(Map, ArcGISTiledMapServiceLayer) {
var _baseMapHost = "http://www.onemap.sg/ArcGIS/rest/services/";
var tileHost1 = "http://t1.onemap.sg/ArcGIS/rest/services/"
var tileHost2 = "http://t2.onemap.sg/ArcGIS/rest/services/";
var _baseMapURL;
var _baseMapURL1;
var _baseMapURL2;
        _baseMapURL = _baseMapHost + "LOT_VIEW" + "/MapServer";
        _baseMapURL1 = tileHost1 + "LOT_VIEW" + "/MapServer";
        _baseMapURL2 = tileHost2 + "LOT_VIEW" + "/MapServer";
   var request = new XMLHttpRequest();
   
          tiled = new ArcGISTiledMapServiceLayer(_baseMapURL, { tileServers: [_baseMapURL1, _baseMapURL2] });
          OneMap.map.addLayer(tiled);
		  console.log(OneMap.map.layerIds);
		  
        }
      );
	  count = count+1;
}

});
</script>
</body>
</html>
